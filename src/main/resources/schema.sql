DROP TABLE IF EXISTS MPA, GENRES, USERS, FILMS, FRIENDSHIP, FILM_GENRES, LIKES CASCADE;

CREATE TABLE IF NOT EXISTS MPA(
    mpa_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name varchar(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS GENRES(
    genre_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name varchar(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS USERS(
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email varchar(255) NOT NULL,
    login varchar(255) NOT NULL,
    name varchar(255) NOT NULL,
    birthday date
);

CREATE TABLE IF NOT EXISTS FILMS(
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name varchar(255) NOT NULL,
    description varchar(255),
    releaseDate date NOT NULL,
    duration int NOT NULL,
    MPA int NOT NULL REFERENCES MPA(mpa_id)
);

CREATE TABLE IF NOT EXISTS FRIENDSHIP(
    requester_id int NOT NULL,
    receiver_id int NOT NULL,
    сonfirmation boolean NOT NULL,
    PRIMARY KEY (requester_id, receiver_id)
);

CREATE TABLE IF NOT EXISTS FILM_GENRES(
    film_id int REFERENCES FILMS (id),
    genre_id int REFERENCES GENRES (genre_id),
    PRIMARY KEY (film_id, genre_id)
);

CREATE TABLE IF NOT EXISTS LIKES(
    user_id int REFERENCES USERS (id),
    film_id int REFERENCES FILMS (id)
);

INSERT INTO MPA VALUES (1, 'G');
INSERT INTO MPA VALUES (2, 'PG');
INSERT INTO MPA VALUES (3, 'PG-13');
INSERT INTO MPA VALUES (4, 'R');
INSERT INTO MPA VALUES (5, 'NC-17');

INSERT INTO GENRES VALUES (1, 'Комедия');
INSERT INTO GENRES VALUES (2, 'Драма');
INSERT INTO GENRES VALUES (3, 'Мультфильм');
INSERT INTO GENRES VALUES (4, 'Триллер');
INSERT INTO GENRES VALUES (5, 'Документальный');
INSERT INTO GENRES VALUES (6, 'Боевик');